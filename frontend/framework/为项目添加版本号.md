一般情况下，为了区分是否发版成功以及部署版本，都会在网页 head 头中添加版本号或者构建时间，不同框架之间亦有不同

## 有预留配置项的框架

### umimax

在 umimax 中有自带的配置项可以在配置文件中通过 `metas` 属性添加版本号

```js
metas: [
  { name: 'verison', content: '1.0.0' },
  { name: 'description', content: 'React framework.' },
],
```

会在网页中 head 头中，或是构建完成后的 html 文件 head 头中添加相关 meta 标签

```html
<meta name="keywords" content="1.0.0" />
<meta name="description" content="React framework." />
```

或者通过 umimax 中插件 API 中的 `addHTMLMetas` 进行设置

```js
{
  content?: string,
  'http-equiv'?: string,
  name?: string,
  scheme?: string
}
```

### vite

通过 vite 暴露的插件钩子函数 `transformIndexHtml` 进行添加, [链接](https://vitejs.cn/vite6-cn/guide/api-plugin.html#transformindexhtml)

```js
const htmlPlugin = () => {
  return {
    name: "html-transform",
    transformIndexHtml(html) {
      return html.replace(
        /<title>(.*?)<\/title>/,
        `<title>Title replaced!</title>`
      );
    },
  };
};
```

## 没有预留的框架

### vue-cli 中 通过 webpack 配置

一般项目都会为用户提供一个 webpack 覆盖入口，如 vue-cli 中的 chainWebpack

chainWebpack 是一个函数，会接收一个基于 webpack-chain 的 ChainableConfig 实例。允许对内部的 webpack 配置进行更细粒度的修改。

vue-cli 已经自引入了 html-webpack-plugin 插件，通过添加版本属性到变量中，在 html 文件中使用

```js
// vue.config.js
const config = require("@/config"); // vue.config.js 是基于node环境运行的，所以这里使用的是require引入
module.exports = {
  chainWebpack: (chainConfig) => {
    // 修改它的选项：
    chainConfig.plugin("html").tap((args) => {
      args[0].verison = config.version;
      return options;
    });
  },
};
```

在 默认的 html 文件 添加预留位

```html
// public/index.html
<meta name="verison" name="<%= html-webpack-plugin.options.version" />
```

### 尝试自己写 js 脚本，通过入口文件注入

比如在 vite 项目中，添加一个 setmeta.js 文件

```js
// meta 信息
export default async function (d: any, c: any, r: any) {
  // d document ， c config , r router
  // 根据传入的信息 自定义一个标签
  let versionElement = d.createElement("meta");
  versionElement.name = "version";
  versionElement.content = `v${c.version}`;
  /**
   * 设置指定元素上的某个属性值。如果属性已经存在，则更新该值；否则，使用指定的名称和值添加一个新的属性。
   * 要获取某个属性当前的值，可使用 getAttribute()；要删除某个属性，可使用 removeAttribute()。
   */
  versionElement.setAttribute("time", new Date().toLocaleString());

  // 编码格式标签
  let charElement = d.createElement("meta");
  charElement.setAttribute("charset", "utf-8");

  // console.log("titleElement", titleElement);

  // router.currentRoute获取需要延时 ，换到下面的方法
  let findRoute: any = Array.from(r.options.routes).find(
    (item: any) => item.path == r.options.history.location
  );
  // console.log("findRoute", findRoute);
  // 判断 r 中是否有标题设置 有就更新
  if (findRoute?.meta?.title) {
    let titleElement = document.head.getElementsByTagName("title")[0];
    titleElement.innerHTML = findRoute.meta.title;
  }

  // 将版本信息推入head头部
  d.head.append(charElement, versionElement);

  console.log("set-meta over");
}
```

在 main 文件中引入

```js
import setmeta from "@/plugins/setmeta";
// 设置一些头部信息
setmeta(document, config, router);
```
