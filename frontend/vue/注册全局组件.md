## vue2 中注册全局组件

```js
// main.js
import Vue from "vue";
import App from "./App.vue";
import MyButton from "@/components/MyButton.vue";

// 注册全局组件
Vue.component("MyButton", MyButton);

new Vue({
  render: (h) => h(App),
}).$mount("#app");
```

### 批量注册时

可以先声明一个注册文件导入所有组件后再导出

```js
// index.js

// 导入所有全局组件
import MyButton from "@/components/MyButton.vue";
import MyInput from "@/components/MyInput.vue";
import MyModal from "@/components/MyModal.vue";

const globalComponents = {
  MyButton,
  MyInput,
  MyModal,
};
```

```js
// main.js
import "./plugins/index.js"; // 导入注册文件
// 批量注册
Object.entries(globalComponents).forEach(([name, component]) => {
  Vue.component(name, component);
});
```

## vue3 中注册全局组件

### 方法一：使用 app.component()

```javascript
// main.js
import { createApp } from "vue";
import App from "./App.vue";

// 导入组件
import MyButton from "@/components/MyButton.vue";
import MyInput from "@/components/MyInput.vue";

const app = createApp(App);

// 注册全局组件
app.component("MyButton", MyButton);
app.component("MyInput", MyInput);

app.mount("#app");
```

### 方法二：使用插件方式

```javascript
// src/plugins/globalComponents.js
import MyButton from "@/components/MyButton.vue";
import MyInput from "@/components/MyInput.vue";
import MyModal from "@/components/MyModal.vue";

const globalComponents = {
  MyButton,
  MyInput,
  MyModal,
};

export default {
  install(app) {
    Object.entries(globalComponents).forEach(([name, component]) => {
      app.component(name, component);
    });
  },
};
javascript;
// main.js
import { createApp } from "vue";
import App from "./App.vue";
import globalComponents from "@/plugins/globalComponents";

const app = createApp(App);

// 使用组件插件 use api 相比于 component 会主动暴露一个 install 方法
app.use(globalComponents);

app.mount("#app");
```

## 自动批量注册全局组件

### 使用 require.context (Vue 2 & Webpack)

```javascript
// src/plugins/autoRegisterComponents.js
import Vue from "vue";

// 自动注册 src/components/global 目录下的所有 .vue 文件
const requireComponent = require.context(
  "@/components/global", // 组件目录
  false, // 是否查询子目录
  /\.vue$/ // 匹配文件的正则
);

requireComponent.keys().forEach((fileName) => {
  // 获取组件配置
  const componentConfig = requireComponent(fileName);

  // 获取组件的 PascalCase 命名
  const componentName = fileName
    .split("/")
    .pop()
    .replace(/\.\w+$/, "");

  // 注册组件
  Vue.component(componentName, componentConfig.default || componentConfig);
});
```

### 使用 import.meta.glob (Vue 3 & Vite)

```javascript
// src/plugins/autoRegisterComponents.js
export default {
  install(app) {
    // 自动导入 global 目录下的所有组件
    const modules = import.meta.glob("@/components/global/*.vue", {
      eager: true,
    });

    Object.entries(modules).forEach(([path, module]) => {
      // 提取组件名
      const componentName = path
        .split("/")
        .pop()
        .replace(/\.\w+$/, "");

      // 注册组件
      app.component(componentName, module.default);
    });
  },
};
```

```javascript
// main.js (Vue 3 + Vite)
import { createApp } from "vue";
import App from "./App.vue";
import autoRegisterComponents from "@/plugins/autoRegisterComponents";

const app = createApp(App);
app.use(autoRegisterComponents);
app.mount("#app");
```
